<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.2.40/vue.global.min.js"></script>
    <script src="https://unpkg.com/jszip@3.10.1/dist/jszip.js"></script>
    <script src=" https://unpkg.com/file-saver@2.0.2/dist/FileSaver.js"></script>
</head>

<body>
    <div id="app">
        <input type="file" webkitdirectory @change="change">
    </div>
</body>
<script>
    const { createApp } = Vue
    createApp({
        data() {
            return {
                message: 'Hello Vue!'
            }
        },
        created() {
        },
        methods: {
            change(e) {
                var files = e.target.files;
                console.log(files);
                const zip = new JSZip();
                let size = 0
                for (var i = 0; i < files.length; i++) {
                    var f = files[i];
                    size += f.size
                    if (size > 1024 * 1024 * 150) {
                        return console.log('The file is too large and cannot exceed 150M');
                        // return setError('The file is too large and cannot exceed 150M');
                    }
                    let fullPath = f.webkitRelativePath
                    let paths = fullPath.split('/')
                    let rootPath = paths[0]
                    if (rootPath.toLowerCase() !== 'location') {
                        // return console.log('Not Location');
                    }
                    // console.log('paths', paths);
                    let path = paths.slice(1, paths.length - 1)
                    // console.log(path);
                    if (path.length) {
                        zip.folder(path.join('/')).file(f.name, f);
                    } else {
                        zip.file(f.name, f);
                    }
                }
                zip.generateAsync({ type: "blob" })
                    .then(function (content) {
                        console.log(content);
                        // see FileSaver.js
                        saveAs(content, "example.zip");
                    });

            }
        },
        mounted() {
        }
    }).mount(document.querySelector('#app'))
</script>

</html>